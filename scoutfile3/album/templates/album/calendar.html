{% extends 'base.html' %}
{% load staticfiles %}
{% block extrahead %}
    <link rel="stylesheet" href="{% static "bootstrap-calendar/css/calendar.css" %}">
    <script type="text/javascript" src="{% static "underscore/underscore-min.js" %}"></script>
    <script type="text/javascript" src="{% static "bootstrap-calendar/js/calendar.js" %}"></script>
    <script type="text/javascript" src="{% static "bootstrap-calendar/js/language/ro-RO.js" %}"></script>
    <script type="text/javascript">

        $(document).ready(function () {

            var options = {
                view: 'month',
                events_source: "{{ events_url }}",
{#                events_source: function () { return [ { "id": "1", "title": "test", "url": "http://192.168.33.10:8000/continut/eveniment/1/", "class": 'event-important', "start": "1389608400000", "end": "1389624000000" } ]},#}

{#                modal: "#events-modal",#}
                tmpl_path: "{{ STATIC_URL }}bootstrap-calendar/tmpls/",
                language: 'ro-RO',

                tmpl_cache: false,
                onAfterEventsLoad: function (events) {
                    if (!events) {
                        return;
                    }
                    var list = $('#eventlist');
                    list.html('');

                    this._loadTemplate("sidebar-eventlist");
                    var calendar = this;
                    $.each(events, function (key, val) {
                        val.date_start = new Date(parseInt(val.start));
                        val.date_end = new Date(parseInt(val.end));
                        $(document.createElement('li'))
                                .html(calendar.options.templates["sidebar-eventlist"]({"event" : val, "calendar" : calendar}))
                                .appendTo(list);
                    });
                },
                onAfterViewLoad: function (view) {
                    $('.page-header h3').text(this.getTitle());
                    $('.btn-group button').removeClass('active');
                    $('button[data-calendar-view="' + view + '"]').addClass('active');
                },
                classes: {
                    months: {
                        general: 'label'
                    }
                },

                modal_type: "template",
                modal_title: function (event) { return event.title }
            };

            var calendar = $('#calendar').calendar(options);

            $('.btn-group button[data-calendar-nav]').each(function () {
                var $this = $(this);
                 $this.click(function () {
                    calendar.navigate($this.data('calendar-nav'));
                });
            });

            $('.btn-group button[data-calendar-view]').each(function () {
                var $this = $(this);
                $this.click(function () {
                    calendar.view($this.data('calendar-view'));
                });
            });
        });

    </script>
    <style>
        #cal-week-box {
            width: 65px;
            left: -66px;
        }
    </style>
{% endblock %}

{% block page_title %}Calendar
<div class = "pull-right btn-group">
        <a class = "btn disabled" href = "{% url album:calendar_centru_local pk=request.user.get_profile.membru.centru_local.id %}"><i class = "icon-calendar"></i> Calendar</a>
        <a class = "btn" href = "{% url album:index%}"><i class = "icon-list"></i> Listă</a>
    </div>

{% endblock %}

{% block context_menu %}
	{% include "album/main_context_menu.html" %}
{% endblock %}


{% block content %}
    <div class="page-header">

        <div class="pull-right form-inline">
            <div class="btn-group">
                <button class="btn btn-primary" data-calendar-nav="prev"><i class = "icon-chevron-left"></i></button>
                <button class="btn" data-calendar-nav="today">Azi</button>
                <button class="btn btn-primary" data-calendar-nav="next"><i class = "icon-chevron-right"></i></button>
            </div>
            <div class="btn-group">
                <button class="btn btn-warning" data-calendar-view="year">An</button>
                <button class="btn btn-warning active" data-calendar-view="month">Lună</button>
                <button class="btn btn-warning" data-calendar-view="week">Săptămână</button>
                <button class="btn btn-warning" data-calendar-view="day">Zi</button>
            </div>
        </div>

        <h3></h3>
    </div>
    <div class = "row-fluid">
    <div class = "span9">
    <div id="calendar"></div>
        </div>
        <div class = "span3">
            			<h4>Evenimente</h4>
			<ul id="eventlist" class="nav nav-list"></ul>
        </div>
    </div>
    <div class="modal hide fade" id="events-modal">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>Eveniment</h3>
        </div>
        <div class="modal-body" style="height: 400px">
        </div>
        <div class="modal-footer">
            <a href="#" data-dismiss="modal" class="btn">Închide</a>
        </div>
    </div>
{% endblock %}